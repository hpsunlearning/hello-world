file <- commandArgs(T)
pdf("CC_risk.pdf",width=20,height=10,bg="#4682B4")
dat <- read.table(file[1],head=T,row.names=1,sep="\t")
dat_case<-read.table(file[2],head=T)
quan <- quantile(dat[1:198,1],c(0.05,0.95))
m <- density(dat[1:198,1],from=quan[1],to=quan[2])
m1 <- density(dat[1:198,1])
m2<-dat[1:198,1]
ymax <- max(m$y)
print(ymax)
par(bg="#AAAAAA",fg="#FFFFFF")
plot(m1,main="CC risk distribution",xlab="CC risk",ylab="percentage in reference",mgp=c(2,0.5,0),ylim=c(0,ymax+1),xaxs="i",yaxs="i",yaxt="n",cex=2,cex.main=2,cex.axis=1.5,cex.lab=1.5,xaxs="i",yaxs="i",col.axis="white",col.sub="white",col.main="white",col.lab="white")
for(i in
    seq(255,0,-1)){polygon(c(-8,(2*i-408)/51,(2*i-408)/51,-8),c(-8,0*i,ymax+1,ymax+1),col=rgb(0.008,0.3,(1-i/255)*0.35+0.25,0.6),border=NA)}
polygon(c(min(m1$x),m1$x,max(m1$x)),c(0,m1$y,0),col="#9AC0CD",border="NA")
lines(m1) 
lines(c(m$x[1],m$x[1]),c(0,m$y[1]),col="#EE0000",lwd=4,lty=2)
lines(c(m$x[512],m$x[512]),c(0,m$y[512]),col="#EE0000",lwd=4,lty=2)
abline(v=dat_case[1,],col="#8B008B",lty=2,lwd=4)
abline(h=ymax*1/5,col="#6E7B8B")
abline(h=ymax*2/5,col="#6E7B8B")
abline(h=ymax*3/5,col="#6E7B8B")
abline(h=ymax*4/5,col="#6E7B8B")
text(m$x[1]-0.03,m$y[1]+0.05,"5%",cex=2)
text(m$x[512]-0.01,m$y[512]+0.12,"95%",cex=2)
arrows(m$x[1]+0.13,m$y[512]/2,m$x[1],m$y[512]/2,col="#454545",cex=1.8)
arrows(m$x[512]-0.13,m$y[512]/2,m$x[512],m$y[512]/2,col="#454545",cex=1.8)
text((m$x[512]-m$x[1])/2+m$x[1],m$y[512]/2,paste("reference range(",round(m$x[1],2),"~",round(m$x[512],2),")",sep=""),cex=2,col="#454545")
text(dat_case[1,]-0.18,4.25,paste(round(100*mean(dat_case[1,]>m2)),"%",sep=""),cex=2.5)
text(dat_case[1,]-0.14,4.25,paste("The value of your Colon Cance risk is ",round(dat_case[1,],2),"\nand is higher than ",round(100*mean(dat_case[1,]>m2)),"% of the population",sep=""),adj=0,cex=1.8)
